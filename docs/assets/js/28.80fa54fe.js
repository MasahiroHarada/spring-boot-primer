(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{204:function(t,a,s){"use strict";s.r(a);var n=s(0),o=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"検索機能を実装しよう"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#検索機能を実装しよう","aria-hidden":"true"}},[t._v("#")]),t._v(" 検索機能を実装しよう")]),s("p",[t._v("このページでは検索機能を追加していきます。")]),s("h2",{attrs:{id:"mapper"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mapper","aria-hidden":"true"}},[t._v("#")]),t._v(" Mapper")]),s("p",[t._v("まずはマッパーの設定を追加します。")]),s("h3",{attrs:{id:"membermapper-java"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#membermapper-java","aria-hidden":"true"}},[t._v("#")]),t._v(" MemberMapper.java")]),s("p",[s("code",[t._v("findByNameLike")]),t._v(" メソッドを追加します。")]),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Mapper")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("MemberMapper")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    List"),s("span",{attrs:{class:"token generics function"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Member"),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("all")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    List"),s("span",{attrs:{class:"token generics function"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Member"),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("findByNameLike")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("String words"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("members テーブルの name 列に対して引数の文字列で LIKE 検索を発行するメソッドです。")]),s("h3",{attrs:{id:"membermapper-xml"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#membermapper-xml","aria-hidden":"true"}},[t._v("#")]),t._v(" MemberMapper.xml")]),s("p",[t._v("XML には "),s("code",[t._v("findByNameLike")]),t._v(" メソッドに対応する SQL を定義します。")]),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("mapper")]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("namespace")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("com.example.search.mappers.MemberMapper"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{attrs:{class:"token comment"}},[t._v("\x3c!-- 中略 --\x3e")]),t._v("\n    "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("select")]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("id")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("findByNameLike"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("resultMap")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("memberResultMap"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("parameterType")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("String"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        SELECT * FROM members WHERE name LIKE '%' || #{words} || '%'\n    "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("select")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("mapper")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[s("code",[t._v("all")]),t._v(" メソッドと異なるのは、"),s("code",[t._v("findByNameLike")]),t._v(" メソッドが引数を取ることです。")]),s("p",[s("code",[t._v("parameterType")]),t._v(" に引数の型を記述します。今回は画面で言うと検索窓に入力した文字列が渡されるので "),s("code",[t._v("String")]),t._v(" です。")]),s("p",[t._v("そして、SQL 文では "),s("code",[t._v("#{引数名}")]),t._v(" で引数を参照できます。引数名は Mapper インターフェース側で定義した引数名に一致します。")]),s("p",[t._v("（ちなみに "),s("code",[t._v("||")]),t._v(" は SQL の機能で文字列結合を行います。最終的に "),s("code",[t._v("LIKE '%あいう%'")]),t._v(" という形で LIKE 検索を行いたいのでこのように記述しています。）")]),s("h2",{attrs:{id:"controller"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#controller","aria-hidden":"true"}},[t._v("#")]),t._v(" Controller")]),s("p",[t._v("コントローラーには "),s("code",[t._v("/api/members")]),t._v(" と "),s("code",[t._v("/api/members/{words}")]),t._v(" にあたる処理を追加する必要があります。")]),s("p",[t._v("既存の "),s("code",[t._v("MemberController")]),t._v(" に追記してもいいのですが、あまり長くなると読みづらいので Ajax 用の処理は別のコントローラークラスに分けることにします。")]),s("p",[s("code",[t._v("com.example.search.controllers")]),t._v(" に "),s("code",[t._v("MemberApiController.java")]),t._v(" を追加してください。")]),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("package")]),t._v(" com"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("example"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("search"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("controllers"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" java"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("List"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" org"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("beans"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("annotation"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Autowired"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" org"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stereotype"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Controller"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" org"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("web"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bind"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("annotation"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetMapping"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" org"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("web"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bind"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("annotation"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PathVariable"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" org"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("web"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bind"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("annotation"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ResponseBody"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" com"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("example"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("search"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("domains"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Member"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" com"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("example"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("search"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mappers"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MemberMapper"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Controller")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("MemberApiController")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("final")]),t._v(" MemberMapper memberMapper"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Autowired")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("MemberApiController")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MemberMapper memberMapper"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("this")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memberMapper "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" memberMapper"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@GetMapping")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"/api/members"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@ResponseBody")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" List"),s("span",{attrs:{class:"token generics function"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Member"),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("all")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        List"),s("span",{attrs:{class:"token generics function"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Member"),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" members "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" memberMapper"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("all")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" members"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@GetMapping")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"/api/members/{words}"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@ResponseBody")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" List"),s("span",{attrs:{class:"token generics function"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Member"),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("find")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@PathVariable")]),t._v(" String words"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        List"),s("span",{attrs:{class:"token generics function"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Member"),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" members "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" memberMapper"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("findByNameLike")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("words"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" members"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"ポイント1：url-のパス部分の値を取得する"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ポイント1：url-のパス部分の値を取得する","aria-hidden":"true"}},[t._v("#")]),t._v(" ポイント1：URL のパス部分の値を取得する")]),s("p",[s("code",[t._v("/api/members/あいう")]),t._v(" のような URL にリクエストが来る想定ですので、この「あいう」の部分の文字列を取得する必要があります。")]),s("p",[t._v("まず、"),s("code",[t._v("@GetMapping")]),t._v(" の引数の記述を "),s("code",[t._v("/api/members/{words}")]),t._v(" というように、取得したい部分を "),s("code",[t._v("{}")]),t._v(" で囲みます。")]),s("p",[t._v("次に、メソッドの引数に "),s("code",[t._v("@PathVariable")]),t._v(" アノテーションを付与します。こうすれば "),s("code",[t._v("{}")]),t._v(" で囲った部分を引数として受け取ることができます。")]),s("h3",{attrs:{id:"ポイント2：json-レスポンスを返却する"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ポイント2：json-レスポンスを返却する","aria-hidden":"true"}},[t._v("#")]),t._v(" ポイント2：JSON レスポンスを返却する")]),s("p",[t._v("HTML を返却する場合はテンプレート名の文字列を返却しました。")]),s("p",[t._v("JSON を返却する場合は、まずメソッドに "),s("code",[t._v("@ResponseBody")]),t._v(" アノテーションを付与します。")]),s("p",[t._v("その上で、オブジェクトをそのまま返してしまいます。そうすると自動的に JSON に変換されてレスポンスメッセージが生成されます。")]),s("h2",{attrs:{id:"javascript-ファイル"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#javascript-ファイル","aria-hidden":"true"}},[t._v("#")]),t._v(" JavaScript ファイル")]),s("p",[s("code",[t._v("src/main/resource/static")]),t._v(" に　"),s("code",[t._v("app.js")]),t._v(" を追加してください。")]),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token comment"}},[t._v("// 検索フォームの値が変わるたびに呼ばれる関数")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("search")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{attrs:{class:"token comment"}},[t._v("// 検索フォームに入力された値をイベントオブジェクトから取得する")]),t._v("\n  "),s("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" words "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" event"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{attrs:{class:"token comment"}},[t._v("// メンバー一覧を表現する要素を取得する")]),t._v("\n  "),s("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" memberList "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("getElementById")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'memberList'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{attrs:{class:"token comment"}},[t._v("// APIのURLを作成する")]),t._v("\n  "),s("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" url "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'/api/members/'")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" words"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{attrs:{class:"token comment"}},[t._v("// JavaScriptからサーバと通信するためのオブジェクト")]),t._v("\n  "),s("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" xhr "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("XMLHttpRequest")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{attrs:{class:"token comment"}},[t._v("// リクエストを初期化する")]),t._v("\n  xhr"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("open")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'GET'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token boolean"}},[t._v("true")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{attrs:{class:"token comment"}},[t._v("// load（通信完了）イベントに関数を登録する")]),t._v("\n  "),s("span",{attrs:{class:"token comment"}},[t._v("// この関数（第2引数）は登録された時点では実行されない")]),t._v("\n  "),s("span",{attrs:{class:"token comment"}},[t._v("// あるイベントが発生したタイミングで実行されるこのような関数を「イベントリスナー」と呼ぶ")]),t._v("\n  xhr"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'load'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token comment"}},[t._v("// サーバからのレスポンス（文字列）をJSONに変換する")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" members "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("parse")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xhr"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseText"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token comment"}},[t._v("// メンバー一覧を書き換える")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" html "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("''")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    members"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("forEach")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("member"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      html "),s("span",{attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'<li class=\"list-group-item\">'")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" member"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'</li>'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    memberList"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" html"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{attrs:{class:"token comment"}},[t._v("// リクエスト発行")]),t._v("\n  xhr"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("send")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("// HTMLの読み込みが完了したタイミングで実行される関数を登録する")]),t._v("\nwindow"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function-variable function"}},[t._v("onload")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{attrs:{class:"token comment"}},[t._v("// 検索フォーム要素を取得する")]),t._v("\n  "),s("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" wordsInput "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("getElementById")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'words'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token comment"}},[t._v("// inputイベントに上で定義したsearch関数を登録する")]),t._v("\n  wordsInput"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'input'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" search"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token boolean"}},[t._v("false")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("処理の内容をコメントに記載しました。")]),s("h2",{attrs:{id:"テンプレートファイル"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#テンプレートファイル","aria-hidden":"true"}},[t._v("#")]),t._v(" テンプレートファイル")]),s("p",[s("code",[t._v("index.html")]),t._v(" に "),s("code",[t._v("app.js")]),t._v(" の読み込みを追記してください。")]),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[t._v("  "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("/app.js"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{attrs:{class:"token script language-javascript"}}),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("h2",{attrs:{id:"アプリケーションを再起動する"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#アプリケーションを再起動する","aria-hidden":"true"}},[t._v("#")]),t._v(" アプリケーションを再起動する")]),s("p",[t._v("アプリケーションを再起動して機能を確かめてみましょう。")])])}],!1,null,null,null);a.default=o.exports}}]);