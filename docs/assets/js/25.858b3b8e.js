(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{187:function(t,a,s){"use strict";s.r(a);var n=s(0),e=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"コントローラーを作成する"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#コントローラーを作成する","aria-hidden":"true"}},[t._v("#")]),t._v(" コントローラーを作成する")]),s("p",[t._v("このページではコントローラーを作成します。")]),s("p",[s("code",[t._v("com.example.search.controllers")]),t._v(" に "),s("code",[t._v("MemberController.java")]),t._v(" を追加してください。")]),s("p",[t._v("まずは TOP 画面から作成します。")]),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("package")]),t._v(" com"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("example"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("search"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("controllers"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" java"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("List"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" org"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("beans"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("annotation"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Autowired"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" org"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stereotype"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Controller"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" org"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ui"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Model"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" org"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("web"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bind"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("annotation"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GetMapping"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" com"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("example"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("search"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("domains"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Member"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" com"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("example"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("search"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mappers"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MemberMapper"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Controller")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("MemberController")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("final")]),t._v(" MemberMapper memberMapper"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Autowired")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("MemberController")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MemberMapper memberMapper"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("this")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memberMapper "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" memberMapper"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@GetMapping")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"/"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" String "),s("span",{attrs:{class:"token function"}},[t._v("index")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Model model"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        List"),s("span",{attrs:{class:"token generics function"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Member"),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" members "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" memberMapper"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("all")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        model"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("addAttribute")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"members"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" members"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"index"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"autowired"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#autowired","aria-hidden":"true"}},[t._v("#")]),s("code",[t._v("@Autowired")])]),s("p",[t._v("まず最初のポイントは "),s("code",[t._v("@Autowired")]),t._v(" アノテーションです。")]),s("p",[t._v("前のページで作成した "),s("code",[t._v("MemberMapper")]),t._v(" を使用したいわけですが、直接 "),s("code",[t._v("new")]),t._v(" でインスタンス化はしません（そもそも"),s("code",[t._v("MemberMapper")]),t._v(" はインターフェースですので "),s("code",[t._v("new")]),t._v(" できません）。代わりにDI（"),s("strong",[t._v("D")]),t._v("ependency "),s("strong",[t._v("I")]),t._v("njection：依存性の注入）という方法を使います。")]),s("p",[t._v("DI はかなり難しいオブジェクト指向のプログラミング手法なので、今すぐに覚えなくて構いません。ただ自分で "),s("code",[t._v("new")]),t._v(" しない方法もある[^1]と知っておいてください。")]),s("p",[t._v("さて "),s("code",[t._v("@Autowired")]),t._v(" をコンストラクタに付与すると、コンストラクタを実行するときに自動的に引数の型のクラスのインスタンスがコンストラクタに渡されます。")]),s("p",[t._v("今回の例では、"),s("code",[t._v("MemberController")]),t._v(" のインスタンスが生成されるとき、コンストラクタに "),s("code",[t._v("MemberMapper")]),t._v(" のインスタンスが渡されるということです。これを "),s("code",[t._v("MemberController")]),t._v(" のプロパティである "),s("code",[t._v("memberMapper")]),t._v(" に代入しています。")]),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Autowired")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("MemberController")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MemberMapper memberMapper"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("this")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("memberMapper "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" memberMapper"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("[^1]: 誤解があるといけないのですが、言語機能としてインスタンス化の方法が "),s("code",[t._v("new")]),t._v(" 以外にあるということではありません。"),s("code",[t._v("new")]),t._v(" の実行をいわば「裏側に隠す」プログラミング手法があるということです。")]),s("h2",{attrs:{id:"テンプレートへのデータの受け渡し"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#テンプレートへのデータの受け渡し","aria-hidden":"true"}},[t._v("#")]),t._v(" テンプレートへのデータの受け渡し")]),s("p",[t._v("次のポイントは、テンプレートへのデータの受け渡しです。")]),s("p",[t._v("Hello world! の例ではただシンプルな画面を返すだけでしたが、今回はコントローラーで取得したデータをテンプレートに渡す必要があります。")]),s("p",[t._v("まずは前のページで定義した "),s("code",[t._v("all")]),t._v(" メソッドでメンバーの一覧を取得します。")]),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[t._v("List"),s("span",{attrs:{class:"token generics function"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Member"),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" members "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" memberMapper"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("all")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("メンバー一覧の HTML を生成するためにこのデータをテンプレートに渡すには、まず "),s("code",[t._v("org.springframework.ui.Model")]),t._v(" 型のインスタンスを "),s("code",[t._v("index")]),t._v(" メソッドで受け取ります。")]),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" String "),s("span",{attrs:{class:"token function"}},[t._v("index")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Model model"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n")])])]),s("p",[t._v("誰が "),s("code",[t._v("model")]),t._v(" を渡すの？？と思うかもしれませんが、こういう風に書けばフレームワークが自動的に渡してくれるのです。")]),s("p",[s("code",[t._v("org.springframework.ui.Model")]),t._v(" 型は、テンプレートへの渡すデータの管理を担当しています。"),s("code",[t._v("addAttribute")]),t._v(" メソッドを呼んでデータを登録します。")]),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[t._v("model"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("addAttribute")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"members"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" members"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("これで、"),s("code",[t._v("index.html")]),t._v(" テンプレートで "),s("code",[t._v("members")]),t._v(" という名前でメンバーの一覧データを参照できるようになりました。")]),s("p",[t._v("次のページではテンプレートを記述します。")])])}],!1,null,null,null);a.default=e.exports}}]);